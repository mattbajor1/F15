import { useEffect, useState } from 'react'
import { useParams } from 'react-router-dom'
import { api } from '../lib/api'
function Tabs({ value, onChange, tabs }:{ value:string; onChange:(v:string)=>void; tabs:{id:string;label:string}[] }){ return (<div className='flex gap-2 border-b border-slate-800 mb-3'>{tabs.map(t=>(<button key={t.id} onClick={()=>onChange(t.id)} className={`px-3 py-2 rounded-t-lg ${value===t.id?'bg-slate-800 text-white border-x border-t border-slate-800':'text-slate-400 hover:text-white'}`}>{t.label}</button>))}</div>) }
export default function ProjectDetail(){ const { id } = useParams(); const [tab,setTab]=useState('details'); const [project,setProject]=useState<any>(null); useEffect(()=>{ (async()=>{ setProject(await api(`/projects/${id}`)) })() },[id]); return (<div className='max-w-6xl mx-auto p-6 space-y-4'><div><h1 className='text-2xl font-semibold'>{project?.name||'Project'}</h1><div className='text-xs text-slate-400 uppercase tracking-widest mt-1'>{project?.status||'Production'}</div></div><Tabs value={tab} onChange={setTab} tabs={[{id:'details',label:'Details'},{id:'tasks',label:'Tasks'},{id:'equipment',label:'Equipment'},{id:'marketing',label:'Marketing'},{id:'invoicing',label:'Invoicing'}]} />{tab==='details'&&<DetailsTab project={project}/>}{tab==='tasks'&&<TasksTab/>}{tab==='equipment'&&<EquipmentTab/>}{tab==='marketing'&&<MarketingTab/>}{tab==='invoicing'&&<InvoicingTab projectName={project?.name}/>}</div>) }
function Card({children}:{children:React.ReactNode}){ return <div className='rounded-xl border border-slate-800 bg-slate-900/40 shadow-card p-4'>{children}</div> }
function DetailsTab({project}:{project:any}){ return (<Card><div className='grid md:grid-cols-3 gap-6'><div><div className='text-slate-400'>Client</div><div className='font-semibold'>{project?.client||'Noir Pictures'}</div></div><div><div className='text-slate-400'>Project Type</div><div className='font-semibold'>{project?.type||'Feature Film'}</div></div><div><div className='text-slate-400'>Status</div><div className='font-semibold'>{project?.status||'Production'}</div></div></div><div className='mt-6'><div className='text-slate-400 mb-1'>Description</div><p className='text-slate-300'>A neoâ€‘noir thriller set in a city that never sleeps. Follows a detective on the edge.</p></div><div className='grid md:grid-cols-3 gap-6 mt-6'><div><div className='text-slate-400 mb-1'>Key Dates</div><div className='space-y-1'><div className='flex justify-between'><span>Photography Start</span><span className='px-2 py-1 rounded-md bg-slate-800'>8/19/2024</span></div><div className='flex justify-between'><span>Photography End</span><span className='px-2 py-1 rounded-md bg-slate-800'>9/24/2024</span></div><div className='flex justify-between'><span>Target Release</span><span className='px-2 py-1 rounded-md bg-slate-800'>2/28/2025</span></div></div></div><div className='md:col-span-2'><div className='text-slate-400 mb-1'>Locations</div><div className='grid sm:grid-cols-3 gap-2'>{['Downtown LA','Angelino Heights','Santa Monica Pier'].map(x=>(<div key={x} className='px-3 py-2 rounded-md bg-slate-800'>{x}</div>))}</div></div></div></Card>) }
function TasksTab(){ const groups=[{name:'Pre-production',items:[{t:'Scout final shooting locations',done:true},{t:'Cast lead roles',done:true}]},{name:'Production',items:[{t:'Shoot downtown chase scene',done:false}]},{name:'Post-production',items:[{t:'Begin rough cut of Act 1',done:false}]}]; return (<Card><div className='text-xl font-semibold mb-3'>Project Tasks</div><div className='grid gap-6'>{groups.map(g=>(<div key={g.name}><div className='font-semibold'>{g.name}</div><div className='mt-2 space-y-2'>{g.items.map((it,i)=>(<label key={i} className='flex items-center gap-2 text-slate-300'><input type='checkbox' defaultChecked={it.done} className='accent-brand'/><span>{it.t}</span><span className='ml-auto px-2 py-1 rounded-md bg-slate-800 text-xs'>8/24/2024</span></label>))}</div></div>))}</div></Card>) }
function EquipmentTab(){ const rows=[{name:'Cinema Camera B',type:'Camera',price:550},{name:'Gimbal Stabilizer',type:'Grip',price:120}]; return (<Card><div className='text-xl font-semibold mb-3'>Assigned Equipment</div><table className='w-full'><thead className='text-slate-400'><tr><th className='py-2 text-left'>Name</th><th className='text-left'>Type</th><th className='text-right'>Rental Price/Day</th></tr></thead><tbody>{rows.map(r=>(<tr key={r.name} className='border-t border-slate-800'><td className='py-2'>{r.name}</td><td>{r.type}</td><td className='text-right'>${r.price.toFixed(2)}</td></tr>))}</tbody></table></Card>) }
function MarketingCard({state}:{state:'Posted'|'Scheduled'}){ return (<div className='rounded-xl border border-slate-800 bg-slate-900/40 p-4 space-y-3'><div className='inline-flex items-center gap-2 text-xs'><span className={`${state==='Posted'?'bg-green-600/20 text-green-300':'bg-yellow-600/20 text-yellow-300'} px-2 py-1 rounded-full`}>{state}</span></div><div className='grid md:grid-cols-[220px,1fr] gap-4'><div className='aspect-[4/3] rounded-lg bg-slate-800'></div><div className='space-y-2'><div className='italic text-slate-300'>'The city holds its breath. #DuskTillDawn'</div><div className='text-slate-400'>Platforms: <span className='ml-2'>Instagram</span></div>{state==='Scheduled'&&<div className='text-slate-400'>Scheduled for: 8/31/2024</div>}</div></div></div>) }
function MarketingTab(){ return (<div className='space-y-4'><div className='text-xl font-semibold'>Marketing Rollout</div><div className='text-slate-400 mb-2'>Plan and track your social media campaign.</div><MarketingCard state='Posted'/><MarketingCard state='Scheduled'/></div>) }
function InvoicingTab({projectName}:{projectName?:string}){ return (<div className='rounded-xl border border-slate-800 bg-slate-900/40 shadow-card p-4'><div className='text-right text-red-400 font-black tracking-[0.3em]'>INVOICE</div><div className='grid md:grid-cols-2 gap-4'><div><div className='font-semibold'>Frame 15</div><div className='text-slate-400 text-sm'>123 Movie Lane, Los Angeles, CA</div></div><div className='text-right'><div className='text-slate-400 text-sm'>Project</div><div className='text-red-400'>{projectName||'Dusk Till Dawn'}</div></div></div><div className='grid sm:grid-cols-2 gap-2 mt-4'><div><div className='text-slate-400 text-sm'>Invoice #</div><input className='w-full px-3 py-2 rounded-md bg-slate-800 border border-slate-700' defaultValue='INV-2025-003'/></div><div><div className='text-slate-400 text-sm'>Date</div><input className='w-full px-3 py-2 rounded-md bg-slate-800 border border-slate-700' defaultValue='09/28/2025'/></div></div><div className='mt-4'><div className='text-slate-400 text-sm mb-1'>Line Items</div><div className='grid grid-cols-[1fr,100px,120px,120px] gap-2 items-center'><input className='px-3 py-2 rounded-md bg-slate-800 border border-slate-700' defaultValue='New Item'/><input className='px-3 py-2 rounded-md bg-slate-800 border border-slate-700 text-right' defaultValue='1'/><input className='px-3 py-2 rounded-md bg-slate-800 border border-slate-700 text-right' defaultValue='0'/><div className='text-right'>$0.00</div></div></div><div className='grid sm:grid-cols-3 gap-2 mt-4'><div><div className='text-slate-400 text-sm'>Notes</div><textarea className='w-full h-20 px-3 py-2 rounded-md bg-slate-800 border border-slate-700'>Thank you for your business!</textarea></div><div className='sm:col-span-2 grid grid-cols-2 gap-2 content-start'><div className='text-right text-slate-400'>Subtotal</div><div className='text-right'>$0.00</div><div className='text-right text-slate-400'>Discount ($)</div><input className='px-3 py-2 rounded-md bg-slate-800 border border-slate-700 text-right' defaultValue='0'/><div className='text-right text-slate-400'>Tax (%)</div><input className='px-3 py-2 rounded-md bg-slate-800 border border-slate-700 text-right' defaultValue='8'/><div className='text-right font-semibold'>Total</div><div className='text-right font-semibold'>$0.00</div></div></div><div className='flex justify-end gap-2 mt-4'><button className='px-3 py-2 rounded-lg border border-slate-700'>Print</button><button className='px-3 py-2 rounded-lg bg-red-600 text-white'>Save Invoice</button></div></div>) }